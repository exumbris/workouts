<div class='top-bar'>
<h1>Recent Workouts</h1>
</div>
<div id='content'></div>
<script type="text/javascript">//Recent Workouts Table and Functionality
var RecentWorkoutsTable = React.createClass({
	loadDataFromServer: function () {
		serverRequest({query_type:"recent_workouts_data"},"json")
		.then(function(data) {
			console.log(data);
			if(data.hash!=this.state.hash){
				this.setState({hash:data.hash,workouts:data.workouts,data:data.raw});
			}
		}.bind(this))
		.catch(function(error) {
			console.error("recent_workouts.php","recent_workouts_data",error);
		});
	},
	getInitialState: function() {
		return {hash:"",workouts:[],data:[]};
	},
	componentDidMount: function() {
		this.loadDataFromServer();
		setInterval(this.loadDataFromServer, 2000);
	},
	changeSorting: function (key,event) {
		
	},
	render: function() {
		var rows = [];
		var rowtype = "odd";
		for( var id in this.state.order){
			rows.push(React.createElement(RecentWorkoutsTableRow,{data:this.state.data[this.state.order[id]],key:"rtr-"+this.state.order[id],workouts:this.state.workouts,rowtype:rowtype}));
			rowtype = (rowtype=="odd")?"even":"odd";
		};
		if(rows.length==0){
			return React.createElement("div",null,
				"No workouts logged."
			);
		}
		return React.createElement("div",null,
			React.createElement("div",{className:(this.state.view=="loading")?"recent-workouts-loading-div":"hidden"},
				React.createElement("i",{className:"fa fa-cog fa-spin fa-3x"})
			),
			React.createElement("div",{className:(this.state.view=="loading")?"hidden":"recent-workouts-table-div"},
				React.createElement("table",{className:"recent-workouts-table"},
					React.createElement("thead",null,
						React.createElement("tr",null,
							React.createElement("th",{className:(typeof this.state.sorting!="undefined")?(this.state.sorting.workout_name.order=="")?"":"sortedby":"",onClick:this.changeSorting.bind(this,"workout_name")},"Workout Name",
								React.createElement("i",{className:(typeof this.state.sorting!="undefined")?(this.state.sorting.workout_name.order=="")?"fa fa-sort":"fa fa-sort-"+this.state.sorting.workout_name.order:"fa fa-sort"})
							),
							React.createElement("th",{className:(typeof this.state.sorting!="undefined")?(this.state.sorting.date.order=="")?"":"sortedby":"",onClick:this.changeSorting.bind(this,"date")},"Date",
								React.createElement("i",{className:(typeof this.state.sorting!="undefined")?(this.state.sorting.date.order=="")?"fa fa-sort":"fa fa-sort-"+this.state.sorting.date.order:"fa fa-sort"})
							),
							React.createElement("th",{className:(typeof this.state.sorting!="undefined")?(this.state.sorting.comments.order=="")?"":"sortedby":"",onClick:this.changeSorting.bind(this,"comments")},"Comments",
								React.createElement("i",{className:(typeof this.state.sorting!="undefined")?(this.state.sorting.comments.order=="")?"fa fa-sort":"fa fa-sort-"+this.state.sorting.comments.order:"fa fa-sort"})
							)
						)
					),
					React.createElement("tbody",null,rows)
				)
			)
		);
	}
});
</script>
<?php
require("RecentWorkoutsTableRow/RecentWorkoutsTableRow.php");
?>
<script type="text/javascript">
var ReactTable = ReactDOM.render(React.createElement(RecentWorkoutsTable,null),document.getElementById('content'));
</script>
